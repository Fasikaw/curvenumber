<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Curve Number by cvitolo</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Curve Number</h1>
        <p class="header">SCS Curve Number method (R package) </p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/cvitolo/r_CurveNumber/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/cvitolo/r_CurveNumber/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/cvitolo/r_CurveNumber">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/cvitolo">cvitolo</a></p>


      </header>
      <section>
        <h1>
<a id="scs-curve-number-method-r-package" class="anchor" href="#scs-curve-number-method-r-package" aria-hidden="true"><span class="octicon octicon-link"></span></a>SCS Curve Number method (R-package)</h1>

<p>The SCS Curve Number (CN) is a well established method for the estimation of direct runoff from storm rainfall, developed by the USDA Soil Conservation Service (Rallison, 1980) and used in hydrologic engineering and environmental impact analyses. </p>

<p>This package allows to calculate:  </p>

<ul>
<li>the direct storm runoff (Q), given rainfall (R) and CN number<br>
</li>
<li>the CN number, given rainfall (R) and runoff (Q) data</li>
</ul>

<p><strong>To cite this software:</strong><br>
C. Vitolo, N. Le Vine, CurveNumber (R package), (2015), GitHub repository, <a href="https://github.com/cvitolo/r_CurveNumber">https://github.com/cvitolo/r_CurveNumber</a>, doi: </p>

<h3>
<a id="background-the-cn-method-in-a-nutshell" class="anchor" href="#background-the-cn-method-in-a-nutshell" aria-hidden="true"><span class="octicon octicon-link"></span></a>Background: the CN method in a nutshell</h3>

<p>The CN number is a dimensionless parameter varying in the range [0,100]. This is tabulated based on land use type and hydrologic soil group. When the CN is known, the potential maximum retention (S) can be calculated using the following formula:</p>

<p><em>S = 1000/CN - 10</em></p>

<p>The storm runoff is then calculated as follows:</p>

<p><em>Q = ((P-0.2S)^2)/(P+0.8S)</em></p>

<p>with <em>P&gt;0.2S</em>, where P is the rainfall depth (in inches).</p>

<p>When both P and Q are known, the CN can be calculated from data as suggested by Hawkins (1993). </p>

<p><strong>References:</strong><br>
Richard H. Hawkins. Asymptotic Determination of Runoff Curve Numbers
from Data. Journal of Irrigation and Drainage Engineering, 119(2):334–345,
March 1993. ISSN 0733-9437. doi: 10.1061/(ASCE)0733-9437(1993)119:
2(334). <a href="http://ascelibrary.org/doi/abs/10.1061/%28ASCE%290733-9437%281993%29119%3A2%28334%29">URL</a></p>

<p>Allen T. Hjelmfelt. Empirical Investigation of Curve Number Technique. Journal of the Hydraulics Division, Vol. 106, No. 9, September 1980, pp. 1471-1476. <a href="http://cedb.asce.org/cgi/WWWdisplay.cgi?9734">URL</a></p>

<p>R. E. Rallison. Origin and evolution of the SCS runoff equation. In ASCE
lrrig. and Drain. Div. Symp. on Watershed Mgmt., Vol. 11, pages 912–
924, New York, New York, USA, 1980. <a href="http://cedb.asce.org/cgi/WWWdisplay.cgi?31601">URL</a></p>

<h3>
<a id="basics" class="anchor" href="#basics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Basics</h3>

<p>Install and load packages</p>

<div class="highlight highlight-R"><pre><span class="pl-c"># Install dependent packages from CRAN:</span>
<span class="pl-vo">x</span> <span class="pl-k">&lt;-</span> c(<span class="pl-s1"><span class="pl-pds">"</span>zoo<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>EcoHydRology<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>udunits2<span class="pl-pds">"</span></span>,<span class="pl-s1"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>)
install.packages(<span class="pl-vo">x</span>)
lapply(<span class="pl-vo">x</span>, <span class="pl-vo">require</span>, <span class="pl-v">character.only</span><span class="pl-k">=</span><span class="pl-c1">T</span>); rm(<span class="pl-vo">x</span>)

<span class="pl-c"># Install dependent packages from github:</span>
install_github(<span class="pl-s1"><span class="pl-pds">"</span>josephguillaume/hydromad<span class="pl-pds">"</span></span>)
install_github(<span class="pl-s1"><span class="pl-pds">"</span>cvitolo/r_CurveNumber<span class="pl-pds">"</span></span>, <span class="pl-v">subdir</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>curvenumber<span class="pl-pds">"</span></span>)</pre></div>

<h3>
<a id="load-the-library-and-some-test-data" class="anchor" href="#load-the-library-and-some-test-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Load the library and some test data</h3>

<p>Library and test dataset can be loaded as follows:</p>

<div class="highlight highlight-R"><pre>library(<span class="pl-vo">curvenumber</span>)
data(<span class="pl-vo">DATA</span>) </pre></div>

<p>DATA is in mm/d but the time step is 1 hour, below is an adjustment:</p>

<div class="highlight highlight-R"><pre><span class="pl-vo">InputTS</span> <span class="pl-k">&lt;-</span> <span class="pl-vo">DATA</span><span class="pl-k">/</span><span class="pl-c1">24</span>; rm(<span class="pl-vo">DATA</span>)</pre></div>

<p>If the adjustment is not made, volumes should be re-calculated as the sum of the streamflow values multiplied by [the time interval length / your main time units]. E.g. if you use mm/day for hourly observations, the multiplier is [hour/day] = 1/24. If your main time units are the same as the time interval (mm/hr for hourly data), the multiplier is 1.</p>

<h3>
<a id="identify-rainfall-runoff-events" class="anchor" href="#identify-rainfall-runoff-events" aria-hidden="true"><span class="octicon octicon-link"></span></a>Identify Rainfall-Runoff events</h3>

<p>According to (Hawkins, 1993), in order to calculate the curve Number, the rainfall and runoff events can be identified separately. Return periods are then matched using the Frequency Matching approach (Hjelmfelt, 1980). </p>

<div class="highlight highlight-R"><pre><span class="pl-vo">df</span>  <span class="pl-k">&lt;-</span> EventIdentification(<span class="pl-v">dataX</span> <span class="pl-k">=</span> <span class="pl-vo">InputTS</span>,
                           <span class="pl-v">hours2extend</span> <span class="pl-k">=</span> <span class="pl-c1">6</span>, <span class="pl-v">plotOption</span> <span class="pl-k">=</span> <span class="pl-c1">FALSE</span>,
                           <span class="pl-v">stepsBack</span> <span class="pl-k">=</span> <span class="pl-c1">5</span>, <span class="pl-v">timeUnits</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>hours<span class="pl-pds">"</span></span>)</pre></div>

<h3>
<a id="calculate-the-curve-number" class="anchor" href="#calculate-the-curve-number" aria-hidden="true"><span class="octicon octicon-link"></span></a>Calculate the Curve Number</h3>

<p>Determine the Curve Number and k coefficient and also plot CN-P behaviour to 
define the type of asymptote</p>

<div class="highlight highlight-R"><pre><span class="pl-vo">coef</span> <span class="pl-k">&lt;-</span> CalculateCN(<span class="pl-v">dfTPQ</span> <span class="pl-k">=</span> <span class="pl-vo">df</span>, <span class="pl-v">PQunits</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>mm<span class="pl-pds">"</span></span>, <span class="pl-v">plotOption</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)</pre></div>

<p>Please note that there are three types of behaviour: </p>

<ul>
<li>"standard" (increasing asymptotically), </li>
<li>"complacent" (decreasing indefinitely) and </li>
<li>"violent" (increasing asymptotically).</li>
</ul>

<p>Here, only the standard behaviour is implemented. In this case, CN (infinity) is
the value of CN that corresponds to the largest rainfall events and can be 
calculated by a nonlinear least squares curve fitting (red line).</p>

<h3>
<a id="calculate-the-direct-storm-runoff" class="anchor" href="#calculate-the-direct-storm-runoff" aria-hidden="true"><span class="octicon octicon-link"></span></a>Calculate the direct storm runoff</h3>

<p>Given the maximum rainfall and the CN number, the potential maximum reterntion (S) and the direct storm runoff (Q) are calculated as follows:</p>

<div class="highlight highlight-R"><pre>CalculateQ(<span class="pl-v">P</span><span class="pl-k">=</span><span class="pl-c1">30</span>, <span class="pl-v">CN</span><span class="pl-k">=</span><span class="pl-c1">86</span>, <span class="pl-v">PQunits</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">"</span>mm<span class="pl-pds">"</span></span>)

<span class="pl-k">$</span><span class="pl-vo">S</span>
[<span class="pl-c1">1</span>] <span class="pl-c1">41.349</span>

<span class="pl-k">$</span><span class="pl-vo">Q</span>
[<span class="pl-c1">1</span>] <span class="pl-c1">7.486</span></pre></div>

<h3>
<a id="warnings" class="anchor" href="#warnings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Warnings</h3>

<p>This package and functions herein are provided as is, without any guarantee.</p>

<h3>
<a id="please-leave-your-feedback" class="anchor" href="#please-leave-your-feedback" aria-hidden="true"><span class="octicon octicon-link"></span></a>Please leave your feedback</h3>

<p>This package was developed by <a href="http://www.imperial.ac.uk/people/c.vitolo">Claudia Vitolo</a> and <a href="http://www.imperial.ac.uk/people/n.le-vine">Nataliya Le Vine</a>. We would greatly appreciate if you could leave your feedbacks via email (<a href="mailto:cvitolodev@gmail.com">cvitolodev@gmail.com</a>).</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-44379190-6");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
